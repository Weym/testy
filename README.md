
<!DOCTYPE html>
	<html>
		<head>
			<meta name="viewport" content="width=device-width, initial-scale=1, height=device-height, interactive-widget=resizes-visual" />
			<link href="//fonts.googleapis.com/css?family=Open+Sans:400,300,600,700" rel="stylesheet" type="text/css" />
			<link href=/homebrew/bundle.css type="text/css" rel='stylesheet' />
			<link rel="icon" href="/assets/favicon.ico" type="image/x-icon" />
			<meta property="og:site_name" content="The Homebrewery - Make your Homebrew content look legit!">
<meta property="og:title" content="üìë Table of Contents - No author.">
<meta property="og:description" content="No description.">
<meta property="og:image" content="https://homebrewery.naturalcrit.com/thumbnail.png">
<meta property="og:type" content="article">
			<meta name="twitter:card" content="summary">
			<title>üìë Table of Contents - The Homebrewery</title>
		</head>
		<body>
			<main id="reactRoot"><div class="homebrew"><div class="sharePage sitePage"><nav><div class="navSection "><a class="navLogo" href="https://www.naturalcrit.com"><svg version="1.1" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100"><path d="M80.644,87.982l16.592-41.483c0.054-0.128,0.088-0.26,0.108-0.394c0.006-0.039,0.007-0.077,0.011-0.116  c0.007-0.087,0.008-0.174,0.002-0.26c-0.003-0.046-0.007-0.091-0.014-0.137c-0.014-0.089-0.036-0.176-0.063-0.262  c-0.012-0.034-0.019-0.069-0.031-0.103c-0.047-0.118-0.106-0.229-0.178-0.335c-0.004-0.006-0.006-0.012-0.01-0.018L67.999,3.358  c-0.01-0.013-0.003-0.026-0.013-0.04L68,3.315V4c0,0-0.033,0-0.037,0c-0.403-1-1.094-1.124-1.752-0.976  c0,0.004-0.004-0.012-0.007-0.012C66.201,3.016,66.194,3,66.194,3H66.19h-0.003h-0.003h-0.004h-0.003c0,0-0.004,0-0.007,0  s-0.003-0.151-0.007-0.151L20.495,15.227c-0.025,0.007-0.046-0.019-0.071-0.011c-0.087,0.028-0.172,0.041-0.253,0.083  c-0.054,0.027-0.102,0.053-0.152,0.085c-0.051,0.033-0.101,0.061-0.147,0.099c-0.044,0.036-0.084,0.073-0.124,0.113  c-0.048,0.048-0.093,0.098-0.136,0.152c-0.03,0.039-0.059,0.076-0.085,0.117c-0.046,0.07-0.084,0.145-0.12,0.223  c-0.011,0.023-0.027,0.042-0.036,0.066L2.911,57.664C2.891,57.715,3,57.768,3,57.82v0.002c0,0.186,0,0.375,0,0.562  c0,0.004,0,0.004,0,0.008c0,0,0,0,0,0.002c0,0,0,0,0,0.004v0.004v0.002c0,0.074-0.002,0.15,0.012,0.223  C3.015,58.631,3,58.631,3,58.633c0,0.004,0,0.004,0,0.008c0,0,0,0,0,0.002c0,0,0,0,0,0.004v0.004c0,0,0,0,0,0.002v0.004  c0,0.191-0.046,0.377,0.06,0.545c0-0.002-0.03,0.004-0.03,0.004c0,0.004-0.03,0.004-0.03,0.004c0,0.002,0,0.002,0,0.002  l-0.045,0.004c0.03,0.047,0.036,0.09,0.068,0.133l29.049,37.359c0.002,0.004,0,0.006,0.002,0.01c0.002,0.002,0,0.004,0.002,0.008  c0.006,0.008,0.014,0.014,0.021,0.021c0.024,0.029,0.052,0.051,0.078,0.078c0.027,0.029,0.053,0.057,0.082,0.082  c0.03,0.027,0.055,0.062,0.086,0.088c0.026,0.02,0.057,0.033,0.084,0.053c0.04,0.027,0.081,0.053,0.123,0.076  c0.005,0.004,0.01,0.008,0.016,0.01c0.087,0.051,0.176,0.09,0.269,0.123c0.042,0.014,0.082,0.031,0.125,0.043  c0.021,0.006,0.041,0.018,0.062,0.021c0.123,0.027,0.249,0.043,0.375,0.043c0.099,0,0.202-0.012,0.304-0.027l45.669-8.303  c0.057-0.01,0.108-0.021,0.163-0.037C79.547,88.992,79.562,89,79.575,89c0.004,0,0.004,0,0.004,0c0.021,0,0.039-0.027,0.06-0.035  c0.041-0.014,0.08-0.034,0.12-0.052c0.021-0.01,0.044-0.019,0.064-0.03c0.017-0.01,0.026-0.015,0.033-0.017  c0.014-0.008,0.023-0.021,0.037-0.028c0.14-0.078,0.269-0.174,0.38-0.285c0.014-0.016,0.024-0.034,0.038-0.048  c0.109-0.119,0.201-0.252,0.271-0.398c0.006-0.01,0.016-0.018,0.021-0.029c0.004-0.008,0.008-0.017,0.011-0.026  c0.002-0.004,0.003-0.006,0.005-0.01C80.627,88.021,80.635,88.002,80.644,87.982z M77.611,84.461L48.805,66.453l32.407-25.202  L77.611,84.461z M46.817,63.709L35.863,23.542l43.818,14.608L46.817,63.709z M84.668,40.542l8.926,5.952l-11.902,29.75  L84.668,40.542z M89.128,39.446L84.53,36.38l-6.129-12.257L89.128,39.446z M79.876,34.645L37.807,20.622L65.854,6.599L79.876,34.645  z M33.268,19.107l-6.485-2.162l23.781-6.487L33.268,19.107z M21.92,18.895l8.67,2.891L10.357,47.798L21.92,18.895z M32.652,24.649  l10.845,39.757L7.351,57.178L32.652,24.649z M43.472,67.857L32.969,92.363L8.462,60.855L43.472,67.857z M46.631,69.09l27.826,17.393  l-38.263,6.959L46.631,69.09z"></path></svg><span class="name">Natural<span class="crit">Crit</span></span></a><a href="/" class="navItem homebrewLogo" target="_self"><div>The Homebrewery</div></a><a href="/changelog" color="purple" icon="far fa-file-alt" class="navItem purple" target="_blank">v3.20.0<i class="far fa-file-alt"></i></a><a class="navItem green patreon" href="https://www.patreon.com/NaturalCrit" color="green" icon="fas fa-heart" target="_blank">help out<i class="fas fa-heart"></i></a></div><div class="navSection titleSection"><div icon="fas fa-info-circle" color="grey" class="navItem grey metadata"><div class="navItem brewTitle">üìë Table of Contents</div><div class="window inactive"><div class="row"><h4>Description</h4><p>No description.</p></div><div class="row"><h4>Authors</h4><p>No authors</p></div><div class="row"><h4>Tags</h4><p>No tags</p></div><div class="row"><h4>Systems</h4><p>No systems</p></div><div class="row"><h4>Updated</h4><p>a few seconds ago</p></div></div><i class="fas fa-info-circle"></i></div></div><div class="navSection "><div color="purple" icon="far fa-file-pdf" class="navItem purple">get PDF<i class="far fa-file-pdf"></i></div><div class="navDropdownContainer "><div color="red" icon="fas fa-code" class="navItem red">source<i class="fas fa-code"></i></div></div><div class="navDropdownContainer recent"><div icon="fas fa-history" color="grey" class="navItem grey">recent brews<i class="fas fa-history"></i></div></div><a href="https://www.naturalcrit.com/login?redirect=" color="teal" icon="fas fa-sign-in-alt" class="navItem teal" target="_self">login<i class="fas fa-sign-in-alt"></i></a></div></nav><div class="content"><div class="brewRenderer"><div class="pages"><div class="phb page" id="p2"><i class="fas fa-spinner fa-spin"></i></div></div></div><div class="popups"></div><div id="preview-toolbar" class="toolBar visible" role="toolbar"><div class="toggleButton"><button title="Hide Preview Toolbar"><i class="fas fa-glasses"></i></button><button title="Show Header Navigation"><i class="fas fa-rectangle-list"></i></button></div><div class="group" role="group" aria-label="Zoom" aria-hidden="false"><button id="fill-width" class="tool" title="Set zoom to fill preview with one page"><i class="fac fit-width"></i></button><button id="zoom-to-fit" class="tool" title="Set zoom to fit entire page in preview"><i class="fac zoom-to-fit"></i></button><button id="zoom-out" class="tool" title="Zoom Out"><i class="fas fa-magnifying-glass-minus"></i></button><input id="zoom-slider" class="range-input tool hover-tooltip" type="range" name="zoom" title="Set Zoom" list="zoomLevels" min="10" max="300" step="1" value="100"/><datalist id="zoomLevels"><option value="100"></option></datalist><button id="zoom-in" class="tool" title="Zoom In"><i class="fas fa-magnifying-glass-plus"></i></button></div><div class="group" role="group" aria-label="Spread" aria-hidden="false"><div class="radio-group" role="radiogroup"><button role="radio" id="single-spread" class="tool" title="Single Page" aria-checked="true"><i class="fac single-spread"></i></button><button role="radio" id="facing-spread" class="tool" title="Facing Pages" aria-checked="false"><i class="fac facing-spread"></i></button><button role="radio" id="flow-spread" class="tool" title="Flow Pages" aria-checked="false"><i class="fac flow-spread"></i></button></div><button class="anchored-trigger tool" style="anchor-name:--spread-settings" id="spread-settings" title="Spread options"><i class="fas fa-gear"></i></button><div class="anchored-box undefined" style="position-anchor:--null" title="Options"><h1>Options</h1><label title="Modify the horizontal space between pages.">Column gap<input type="range" min="0" max="200" class="range-input" value="10"/></label><label title="Modify the vertical space between rows of pages.">Row gap<input type="range" min="0" max="200" class="range-input" value="5"/></label><label title="Start 1st page on the right side, such as if you have cover page.">Start on right<input type="checkbox" title="Switch to Facing to enable toggle." checked=""/></label><label title="Toggle the page shadow on every page.">Page shadows<input type="checkbox" checked=""/></label></div></div><div class="group" role="group" aria-label="Pages" aria-hidden="false"><button id="previous-page" class="previousPage tool" type="button" title="Previous Page(s)" disabled=""><i class="fas fa-arrow-left"></i></button><div class="tool"><input id="page-input" class="text-input" type="text" name="page" title="Current page(s) in view" inputMode="numeric" pattern="[0-9]" style="width:undefinedch" value="1"/><span id="page-count" title="Total Page Count">/ <!-- -->6</span></div><button id="next-page" class="tool" type="button" title="Next Page(s)"><i class="fas fa-arrow-right"></i></button></div></div><iframe id="BrewRenderer" style="width:100%;height:100%;visibility:hidden"></iframe></div></div></div></main>
			<script src=/homebrew/bundle.js></script>
			<script>start_app({"version":"3.20.0","url":"/share/9_hHy2lr8FIx","brew":{"text":"# üìë Table of Contents\n\n1. [üöÄ Project Overview](#-project-micro-blog-architectural-deep-dive)\n2. [üéØ Core Objectives](#-core-objectives)\n3. [üèóÔ∏è System Architecture](#-system-architecture--services)\n4. [üìã Requirements Breakdown](#-requirements-breakdown)\n5. [üìë API Reference](#-api-reference)\n6. [üõ†Ô∏è How to Run the Project](#-how-to-run-the-project)\n7. [‚ö° Automation Script (start-blog.sh)](#-automation-script-start-blogsh)\n8. [üß† Lessons Learned: Data Consistency](#-lessons-learned-data-consistency--reliability)\n9. [üõ†Ô∏è Troubleshooting](#-troubleshooting)\n\n<br><br><br>\n\n# üöÄ Project: Micro-Blog. An Architectural Deep-Dive.\n\n\nThis project is a foundational exercise to understand microservices. It is built from scratch to reveal underlying patterns.\n\n<br><br><br><br><br>\n\n### üéØ Core Objectives\n- **Infrastructure:** Understand service boundaries, data isolation, and inter-service communication.\n- **Zero-Dependency Logic:** Implement core logic from scratch to avoid \"black box\" abstractions.\n- **Reliability:** Ensure the system remains partially functional even if one service fails (e.g., Comments go down, Posts stay up).\n- **Event-Driven Awareness:** Manage state and synchronization across multiple services via an Event Bus.\n\n### üèóÔ∏è System Architecture\n\nEach resource is handled by an independent service with its own in-memory storage.\n\n| Service        | Port | Responsibility               | Data Managed                            |\n| :------------- | :--- | :--------------------------- | :-------------------------------------- |\n| **Client**     | 3000 | React Frontend               | N/A                                     |\n| **Posts**      | 4000 | Create/List Posts            | `{ id: { id, title } }`                 |\n| **Comments**   | 4001 | Create/List Comments         | `{ postId: [{ id, content, status }] }` |\n| **Query**      | 4002 | Data Aggregation (Read-side) | `{ id: { id, title, comments: [] } }`   |\n| **Moderation** | 4003 | Filter content (\"orange\")    | N/A (Logic only)                        |\n| **Event Bus**  | 4005 | Event Broker                 | `events[]` (Full history)               |\n\n\n### üìã Requirements Breakdown\n\n#### 1. Business Requirements\n\n- **Content:** Users can create posts and comment on them.\n- **Engagement Analytics:** Every post displays a total comment counter.\n- **Moderation:** Comments containing the word \"orange\" must be flagged and hidden.\n\n#### 2. Functional Requirements\n\n- **CORS Support:** Services must use `cors` middleware to allow requests from the frontend.\n- **Async Communication:** Use an Event Bus to notify other services of `PostCreated`, `CommentCreated`, and `CommentUpdated`.\n- **Query Optimization:** A dedicated Query Service assembles posts and comments into a single data structure to minimize frontend requests.\n\n#### 3. Non-Functional Requirements\n\n- **Independent Scaling:** Each service runs on its own port and manages its own state.\n- **Eventual Consistency:** Data syncs across services via events; the UI updates once the moderation cycle completes.\n- **Self-Healing (Sync on Startup):** If a service goes down, it fetches missed events from the Event Bus upon restarting to get \"up to speed.\"\n\n\n### üîÑ The Moderation Event Flow\n\n1.  **Creation:** `Comments Service` saves a comment with `status: 'pending'` and emits `CommentCreated`.\n2.  **Broadcasting:** `Event Bus` sends the event to `Query` (to show \"pending\" to the user) and `Moderation`.\n3.  **Logic:** `Moderation Service` checks for \"orange\" and emits `CommentModerated` with a status of `approved` or `rejected`.\n4.  **Update:** `Comments Service` receives moderation result, updates local store, and emits `CommentUpdated`.\n5.  **Final Sync:** `Query Service` receives `CommentUpdated` and updates the final UI view.\n\n\n\n\n\\page\n\n## üõ†Ô∏è Key Implementation Snippets\n\n### Event Bus Persistence (Handling Service Downtime)\n\nTo handle missing events, the Event Bus stores every event in an array. When a service like **Query** restarts, it hits the `/events` endpoint to replay the history.\n\n```javascript\n// event-bus/index.js\nconst events = []\n\napp.post(\"/events\", (req, res) => {\n  const event = req.body\n  events.push(event) // The \"Memory\" of our system\n\n  // Broadcast to all active services\n  axios.post(\"http://localhost:4000/events\", event).catch(e => console.log(e))\n  axios.post(\"http://localhost:4001/events\", event).catch(e => console.log(e))\n  axios.post(\"http://localhost:4002/events\", event).catch(e => console.log(e))\n  axios.post(\"http://localhost:4003/events\", event).catch(e => console.log(e))\n\n  res.send({ status: \"OK\" })\n})\n```\n\n### Query Service Recovery\n\n```javascript\n// query/index.js\napp.listen(4002, async () => {\n  console.log(\"Listening on 4002\")\n  // Fetch and process all previous events to stay in sync\n  const res = await axios.get(\"http://localhost:4005/events\")\n\n  for (let event of res.data) {\n    handleEvent(event.type, event.data)\n  }\n})\n```\n\n\\column\n\n## ‚ö†Ô∏è Critical Lessons\n\n- **Data Isolation**: Never allow one service to access another service's database.\n- **Eventual Consistency**: Accept that the Query service might be a few milliseconds behind the primary data services.\n- **Sync Logic**: Replaying events is powerful but requires careful handling of data (Idempotency) to avoid processing the same event twice.\n\n\\page\n\n# üìë API Reference\n\nBelow is the routing table for the entire microservices cluster. This includes public-facing routes (Client -> Service) and internal-system routes (Service -> Event Bus).\n\n<br><br><br><br>\n\n### üèóÔ∏è 1. Posts Service (Port 4000)\n\n| Method   | Endpoint  | Description                  | Payload                         |\n| :------- | :-------- | :--------------------------- | :------------------------------ |\n| **GET**  | `/posts`  | Returns all posts in memory. | N/A                             |\n| **POST** | `/posts`  | Creates a new post.          | `{ \"title\": \"String\" }`         |\n| **POST** | `/events` | Listens for system events.   | `{ \"type\": \"...\", \"data\": {} }` |\n\n\n### üí¨ 2. Comments Service (Port 4001)\n\n| Method   | Endpoint              | Description                                 | Payload                         |\n| :------- | :-------------------- | :------------------------------------------ | :------------------------------ |\n| **GET**  | `/posts/:id/comments` | Returns comments for a specific post.       | N/A                             |\n| **POST** | `/posts/:id/comments` | Adds a comment (starts as 'pending').       | `{ \"content\": \"String\" }`       |\n| **POST** | `/events`             | Listens for system events (updates status). | `{ \"type\": \"...\", \"data\": {} }` |\n\n### üîç 3. Query Service (Port 4002)\n\n_The primary \"Read\" service for the React application._\n\n| Method   | Endpoint  | Description                            | Payload                         |\n| :------- | :-------- | :------------------------------------- | :------------------------------ |\n| **GET**  | `/posts`  | Returns aggregated Posts + Comments.   | N/A                             |\n| **POST** | `/events` | Listens for events to build its cache. | `{ \"type\": \"...\", \"data\": {} }` |\n\n\\column\n\n### ‚öñÔ∏è 4. Moderation Service (Port 4003)\n\n_Note: No public GET routes; this service only reacts to the Event Bus._\n\n| Method   | Endpoint  | Description                        | Payload                             |\n| :------- | :-------- | :--------------------------------- | :---------------------------------- |\n| **POST** | `/events` | Filters \"orange\" and emits status. | `{ \"type\": \"CommentCreated\", ... }` |\n\n### üöå 5. Event Bus (Port 4005)\n\n| Method   | Endpoint  | Description                                | Payload                         |\n| :------- | :-------- | :----------------------------------------- | :------------------------------ |\n| **GET**  | `/events` | Returns the historical event log.          | N/A                             |\n| **POST** | `/events` | Broadcasts received event to all services. | `{ \"type\": \"...\", \"data\": {} }` |\n\n---\n\n### üì° Event Schema Logic\n\nThe services communicate using a standard JSON structure. Here are the primary events you've implemented:\n\n#### `PostCreated`\n\n- **Source:** Posts Service\n- **Data:** `{ \"id\": \"123\", \"title\": \"My First Post\" }`\n\n#### `CommentCreated`\n\n- **Source:** Comments Service\n- **Data:** `{ \"id\": \"abc\", \"content\": \"Hello\", \"postId\": \"123\", \"status\": \"pending\" }`\n\n#### `CommentModerated`\n\n- **Source:** Moderation Service\n- **Data:** `{ \"id\": \"abc\", \"postId\": \"123\", \"status\": \"approved/rejected\", \"content\": \"Hello\" }`\n\n#### `CommentUpdated`\n\n- **Source:** Comments Service\n- **Data:** `{ \"id\": \"abc\", \"postId\": \"123\", \"status\": \"approved/rejected\", \"content\": \"Hello\" }`\n\n---\n\n### üõ†Ô∏è Testing via Postman\n\n{{note\nWhen testing manually, ensure you use the following header for all POST requests:\n`Content-Type: application/json`\n}}\n\n\\page\n\n# üõ†Ô∏è How to Run the Project\n\nFollow these steps to get the entire microservices ecosystem up and running. Since these services are independent, you will need multiple terminal windows open.\n\n<br><br><br><br>\n\n### 1. Prerequisites\n\nEnsure you have **Node.js** and **npm** installed on your machine.\n\n### 2. Dependency Installation\n\nNavigate into each project folder and install the necessary dependencies:\n\n```bash\n# Repeat this for: posts, comments, query, moderation, event-bus, and client\ncd posts && npm install\ncd ../comments && npm install\ncd ../query && npm install\ncd ../moderation && npm install\ncd ../event-bus && npm install\ncd ../client && npm install\n```\n\n---\n\n### 3. Startup Order (Recommended)\n\nTo ensure event broadcasting and data synchronization work correctly, start the services in this specific order:\n\n1. Event Bus (Port 4005): Start this first so it can receive and store events.\n2. Data Services (Posts & Comments): Ports 4000 and 4001.\n3. Moderation Service (Port 4003): Required to process comment logic.\n4. Query Service (Port 4002): Upon startup, it will fetch the event history from the Event Bus.\n5. Client (Port 3000): The React frontend.\n\nCommand to start in each folder:\n`npm start`\n\n---\n\n### 4. Terminal Configuration\n\nYou should have 6 terminals running simultaneously:\n\n- Terminal 1: posts\n- Terminal 2: comments\n- Terminal 3: query\n- Terminal 4: moderation\n- Terminal 5: event-bus\n- Terminal 6: client\n\n---\n\n### 5. Operational Test Flow\n\n1. Open your browser to http://localhost:3000.\n2. Create a Post: Check the posts and event-bus terminals for the PostCreated log.\n3. Create a Comment:\n   - Write a standard comment (e.g., \"Great post!\"). It should briefly show as \"pending\" and then be approved.\n   - Write a comment containing the word \"orange\". It should be automatically rejected by the Moderation Service.\n4. Resilience Test:\n   - Shut down the Query Service (Ctrl+C).\n   - Create a new Post while it is offline.\n   - Restart the Query Service.\n   - Refresh the browser; the post should appear via the Event Sync logic.\n\n\\page\n\n# ‚ö° Automation Script (start-blog.sh)\n\nSave the following code into a file named `start-blog.sh` in your root directory to open all services at once.\n\n<br><br><br><br>\n\n### For macOS (New Terminal Tabs):\n\n```bash\n#!/bin/bash\nosascript -e 'tell application \"Terminal\"\ndo script \"cd '$(pwd)'/event-bus && npm start\"\n    do script \"cd '$(pwd)'/posts && npm start\"\ndo script \"cd '$(pwd)'/comments && npm start\"\n    do script \"cd '$(pwd)'/moderation && npm start\"\ndo script \"cd '$(pwd)'/query && npm start\"\n    do script \"cd '$(pwd)'/client && npm start\"\nend tell'\n```\n\n### For Linux / Windows Git Bash (Background processes):\n\n```bash\n#!/bin/bash\necho \"Starting Microservices...\"\ncd event-bus && npm start &\ncd posts && npm start &\ncd comments && npm start &\ncd moderation && npm start &\ncd query && npm start &\ncd client && npm start &\necho \"All services are starting. Use 'killall node' to stop.\"\n```\n\n\n\\column\n\n## üìë API Reference\n\n### Key System Events:\n\n- **PostCreated**: { id, title }\n- **CommentCreated**: { id, content, postId, status: 'pending' }\n- **CommentModerated**: { id, postId, status, content }\n- **CommentUpdated**: { id, postId, status, content }\n\n### Troubleshooting:\n\nIf a port is blocked (e.g., 4000), use:\n```bash\n\n# Mac/Linux\n\nlsof -i :4000\nkill -9 [PID]\n\n# Windows (PowerShell)\n\nstop-process -Id (Get-NetTCPConnection -LocalPort 4000).OwningProcess -Force\n```\n\n\\page\n\n# üß† Lessons Learned: Data Consistency & Reliability\n\n\nBuilding this from scratch reveals the \"hidden\" challenges of distributed systems. Here are the core architectural takeaways:\n\n<br><br><br><br><br>\n\n### 1. The Fallacy of \"Instant\" Data\n\nIn a monolith, you use a database `JOIN`. In microservices, we use **Eventual Consistency**.\n\n- **The Reality:** When a user submits a comment, it might take 50ms to hit the Event Bus, 50ms to hit Moderation, and 50ms to hit the Query service.\n- **The Lesson:** The UI must be designed to handle \"Awaiting Moderation\" states, as the data is not updated in all services at the exact same microsecond.\n\n### 2. Service Independence vs. Failure Cascades\n\nOne of our core goals was **Reliability**.\n\n- **What we saw:** If the `Comments` service dies, users can still view and create `Posts`.\n- **The Lesson:** By isolating data, we prevent a bug in one feature from crashing the entire application. This is called \"Graceful Degradation.\"\n\n### 3. The Power of the \"Event Store\" (Reconciliation)\n\nWe learned that services are \"forgetful\" by nature.\n\n- **The Problem:** If `Query` crashes, it loses its in-memory state.\n- **The Solution:** The Event Bus acts as a **Source of Truth**. By replaying the event log, the service can reconstruct its state without asking the `Posts` or `Comments` services for help.\n- **The Lesson:** Storage is cheap; keeping a log of every change that ever happened (Event Sourcing) makes your system much more resilient.\n\n### 4. Database Per Service\n\n- **The Rule:** No service is allowed to \"reach into\" another service's database.\n- **Why?** If the `Post` service changes its data structure, the `Comment` service shouldn't break.\n- **The Lesson:** Communication should only happen through well-defined API contracts or Events. This allows teams to update services independently.\n\n### 5. Transport Reliability (The \"Next Step\")\n\n- **The Gap:** Currently, if the `Event Bus` fails to send an event, that data is lost forever.\n- **The Fix:** In a production environment, we would use a **Message Broker** (RabbitMQ/Kafka) that \"retries\" until the receiving service acknowledges it has saved the data.\n","shareId":"9_hHy2lr8FIx","title":"üìë Table of Contents","pageCount":6,"description":"","tags":[],"systems":[],"lang":"en","renderer":"V3","authors":[],"invitedAuthors":[],"published":false,"thumbnail":"","createdAt":"2025-12-31T05:56:13.545Z","updatedAt":"2025-12-31T05:56:14.531Z","views":0,"version":2,"lastViewed":"2025-12-31T05:56:13.545Z","textBin":"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","theme":"5ePHB","gDrive":false,"trashed":false,"snippets":""},"config":{"local":false,"publicUrl":"https://homebrewery.naturalcrit.com","baseUrl":"https://homebrewery.naturalcrit.com","environment":"production","deployment":""},"ogMeta":{"site_name":"The Homebrewery - Make your Homebrew content look legit!","title":"üìë Table of Contents - No author.","description":"No description.","image":"https://homebrewery.naturalcrit.com/thumbnail.png","type":"article"}})</script>
		</body>
	</html>
	
